webpackJsonp([27],{mBoz:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("c/w/"),o=a("0qgA"),n=a("ANQr"),s=(a("w3CS"),{name:"timingTaskform",components:{formFile:a("gnUw").a},props:{formId:{type:String,default:""}},data:function(){return{option:{name:"定时任务",apiName:"timingTask",labelWidth:"150px",callback:{submitCallback:"submitCallback"},initObject:{id:this.formId},hasPermission:{save:{isShow:!0,isPermission:!0},back:{isShow:!0,isPermission:!0}},formObject:{},columns:[{label:"任务名称",value:"jobName",type:"input",disHid:!1,disabled:!1,rule:[{required:!0,message:"任务名称不能为空",trigger:"blur"},{min:0,max:64,message:"任务名称长度必须介于 0 到 64 之间",trigger:"blur"}]},{label:"任务分组",value:"jobGroup",type:"input",disHid:!1,disabled:!1,rule:[{required:!0,message:"任务分组不能为空",trigger:"blur"},{min:0,max:64,message:"任务分组长度介于 0 到 64 之间",trigger:"blur"}]},{label:"任务类",value:"beanClass",type:"input",disHid:!1,disabled:!1,rule:[{required:!0,message:"任务类不能为空",trigger:"blur"},{min:0,max:64,message:"任务类长度必须介于 0 到 64 之间",trigger:"blur"}]},{label:"cron表达式",value:"cronExpression",type:"input",disHid:!1,disabled:!1,rule:[{required:!0,message:"cron表达式不能为空",trigger:"blur"},{min:0,max:64,message:"cron表达式长度必须介于 0 到 64 之间",trigger:"blur"}]},{label:"任务是否有状态",value:"isConcurrent",type:"select",dict:{dictType:"",dictData:[{value:"1",label:"有"},{value:"0",label:"无"}]},rule:[{required:!0,message:"任务是否有状态不能为空",trigger:"change"}]},{label:"任务状态",value:"jobStatus",type:"select",dict:{dictType:"",dictData:[{value:"1",label:"启用"},{value:"0",label:"禁用"}]},rule:[{required:!0,message:"任务状态不能为空",trigger:"change"}]},{label:"方法名",value:"methodName",type:"input",disHid:!1,disabled:!1},{label:"springBean",value:"springBean",type:"input",disHid:!1,disabled:!1},{label:"任务描述",value:"description",type:"textarea",disHid:!1,disabled:!1}],formChildInfo:[]}}},created:function(){},methods:{submitCallback:function(e){var t=this;e.$refs.ruleForm.validate(function(a){if(!a)return e.loading=!1,console.log("表单验证失败"),!1;"0"==t.option.formObject.isConcurrent&&(t.option.formObject.jobStatus="0"),t.$store.dispatch("timingTask_save",t.option.formObject).then(function(a){"200"==a.code?(t.$message({message:"保存成功",showClose:!0,type:"success",duration:3e3}),t.goBack()):t.$message({message:a.message||"保存失败",showClose:!0,type:"error",duration:3e3}),e.loading=!1})})},goBack:function(){this.$emit("goBack")}}}),l={render:function(){var e=this.$createElement;return(this._self._c||e)("form-file",{attrs:{option:this.option},on:{goBack:this.goBack,submitCallback:this.submitCallback}})},staticRenderFns:[]},r=a("C7Lr")(s,l,!1,null,null,null).exports,c={name:"timingTaskList",components:{tree:i.a,quickTable:o.a,quickForm:r,baseButton:n.a},data:function(){return{option:{selection:!1,showIndex:!0,tableMenu:!0,isPage:!0,operWidth:300,name:"定时任务",apiName:"timingTask",activeName:"timingTask",formId:"",searchObject:{jobName:"",jobStatus:"",methodName:"",pageNo:1,pageSize:15},hasPermission:{edit:{isShow:!0,isPermission:!0},del:{isShow:!0,isPermission:!0}},columns:[{label:"任务名称",prop:"jobName"},{label:"任务分组",prop:"jobGroup"},{label:"任务类",prop:"beanClass"},{label:"方法名",prop:"methodName"},{label:"cron表达式",prop:"cronExpression"},{label:"任务状态",prop:"jobStatus",dict:{dictType:"",dictData:[{value:"1",label:"启用"},{value:"0",label:"禁用"}]}},{label:"任务描述",prop:"description"},{label:"任务是否有状态",prop:"isConcurrent",dict:{dictType:"",dictData:[{value:"1",label:"有"},{value:"0",label:"无"}]}}],searchColums:[{label:"任务名称",value:"jobName",type:"input"},{label:"方法名",value:"methodName",type:"input"},{label:"任务状态",value:"jobStatus",type:"select",dict:{dictType:"",dictData:[{value:"1",label:"启用"},{value:"0",label:"禁用"}]}}]}}},created:function(){},methods:{stopAndStarttimer:function(e,t){var a=this,i="0"==t?"禁用":"启用";i="您确定要"+i+"该任务？",this.$confirm(i,"",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.$store.dispatch("timingTask_changeJobStatus",{id:e,cmd:t}).then(function(e){"200"==e.code?(a.$message({message:("0"==t?"禁用":"启用")+"成功",showClose:!0,type:"success",duration:3e3}),a.$refs.quickTable.getList(),console.log(a.$refs.quickTable)):a.$message({message:("0"==t?"禁用":"启用")+"失败",showClose:!0,type:"error",duration:3e3})})}).catch(function(){})},goBack:function(){this.option.formId="",this.option.activeName="timingTask",this.$refs.quickTable.getList()},handleClick:function(e,t){"timingTask"==e.name&&(this.option.formId="")}}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",{},[a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.option.activeName,callback:function(t){e.$set(e.option,"activeName",t)},expression:"option.activeName"}},[a("el-tab-pane",{attrs:{label:"定时任务列表",name:"timingTask"}},[a("quick-table",{ref:"quickTable",attrs:{option:e.option},scopedSlots:e._u([{key:"menu",fn:function(t){var i=t.row;return["0"===i.jobStatus?a("base-button",{attrs:{type:"success",icon:"el-icon-circle-check-outline",size:"mini",content:"启用"},on:{buttonEvent:function(t){return e.stopAndStarttimer(i.id,"1")}}}):e._e(),e._v(" "),"1"===i.jobStatus?a("base-button",{attrs:{type:"warning",icon:"el-icon-circle-close-outline",size:"mini",content:"禁用"},on:{buttonEvent:function(t){return e.stopAndStarttimer(i.id,"0")}}}):e._e()]}}])})],1),e._v(" "),a("el-tab-pane",{attrs:{label:""==e.option.formId?"定时任务添加":"定时任务编辑",name:"timingTaskform"}},["timingTaskform"==e.option.activeName?a("quick-form",{attrs:{formId:e.option.formId},on:{goBack:e.goBack}}):e._e()],1)],1)],1)])},staticRenderFns:[]},m=a("C7Lr")(c,u,!1,null,null,null);t.default=m.exports}});