webpackJsonp([7],{DfwC:function(t,e){},Nb1p:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("QhK4"),o=(i("w3CS"),{name:"areaform",components:{formFile:i("gnUw").a},props:{formId:{type:String,default:""},formParentId:{type:String,default:""}},data:function(){return{option:{name:"区域",apiName:"area",callback:{},initObject:{id:this.formId,parentId:this.formParentId},hasPermission:{save:{isShow:!0,isPermission:!0},back:{isShow:!0,isPermission:!0}},formObject:{},columns:[{label:"上级区域",value:"parentId",name:"parentName",type:"tree",tree:{isMultiple:!1,defaultProps:{id:"id",children:"children",label:"text"},treeMethod:"area_getAreTree",treeObject:{extId:"",isAllGrade:!1},treeData:[]},rule:[{required:!0,message:"上级区域不能为空"}]},{label:"区域名称",value:"name",type:"input",disHid:!1,disabled:!1,rule:[{required:!0,message:"区域名称不能为空",trigger:"blur"},{min:0,max:64,message:"区域名称长度需介于 0 到 64 之间",trigger:"blur"}]},{label:"区域编码",value:"code",type:"input",disHid:!1,disabled:!1,rule:[{required:!0,message:"区域编码不能为空",trigger:"blur"},{min:0,max:64,message:"区域编码称长度需介于 0 到 64 之间",trigger:"blur"}]},{label:"区域类型",value:"type",type:"select",disHid:!1,disabled:!1,dict:{dictType:"sys_area_type",dictData:[]},rule:[{min:0,max:64,message:"区域类型必须介于 0 到 64 之间",trigger:"blur"}]},{label:"备注",value:"remarks",type:"textarea",disHid:!1,disabled:!1,rule:[{min:0,max:500,message:"备注必须介于 0 到 500 之间",trigger:"blur"}]}],formChildInfo:[]}}},computed:{},created:function(){},methods:{initCallback:function(){},goBack:function(){this.$emit("goBack")}}}),n={render:function(){var t=this.$createElement;return(this._self._c||t)("form-file",{attrs:{option:this.option},on:{goBack:this.goBack,initCallback:this.initCallback}})},staticRenderFns:[]},s=i("C7Lr")(o,n,!1,null,null,null).exports,r={name:"AreaList",components:{treeTable:a.a,areaform:s},data:function(){return{activeName:"area",option:{children:"children",expandAll:!0,selection:!1,tableMenu:!0,name:"区域",apiName:"area",activeName:"area",formId:"",formParentId:"",hasPermission:{edit:{isShow:!0,isPermission:!0},del:{isShow:!0,isPermission:!0},addSub:{isShow:!0,isPermission:!0}},columns:[{label:"区域名称",prop:"text",width:300,isClick:!1},{label:"区域编码",prop:"code",width:300},{label:"区域类型",prop:"type",width:"",dict:{dictType:"sys_area_type",dictData:[]}}]}}},computed:{formLabel:function(){return this.option.formId||this.option.formParentId?"区域编辑":"区域添加"}},created:function(){},methods:{goBack:function(){this.option.formId="",this.option.formParentId="",this.option.activeName="area",this.$refs.quickTreeTable.refresh()},handleClick:function(t,e){"area"==t.name&&(this.option.formId="",this.option.formParentId="")}}},l={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{},[i("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.option.activeName,callback:function(e){t.$set(t.option,"activeName",e)},expression:"option.activeName"}},[i("el-tab-pane",{attrs:{label:"区域列表",name:"area"}},[i("tree-table",{ref:"quickTreeTable",attrs:{option:t.option}})],1),t._v(" "),i("el-tab-pane",{attrs:{label:t.formLabel,name:"areaform"}},["areaform"==t.option.activeName?i("areaform",{attrs:{formParentId:t.option.formParentId,formId:t.option.formId},on:{goBack:t.goBack}}):t._e()],1)],1)],1)},staticRenderFns:[]},c=i("C7Lr")(r,l,!1,null,null,null);e.default=c.exports},QhK4:function(t,e,i){"use strict";var a=i("oAV5"),o=i("dqd5"),n=i("ANQr"),s={components:{tableOpear:o.a,baseButton:n.a},name:"treeTable",props:{option:{type:Object,default:function(){}}},data:function(){return{columnsShow:[],formatData:[],loadShow:!0,scrollShow:!0,allData:[]}},created:function(){this.initData(),this.getList()},mounted:function(){document.getElementsByClassName("el-scrollbar__wrap")[2]&&document.getElementsByClassName("el-scrollbar__wrap")[2].addEventListener("scroll",this.loadData)},computed:{},methods:{changeColumn:function(t){this.columnsShow=t},refresh:function(){this.loadShow=!0,this.scrollShow=!0,this.getList()},loadData:function(){var t=document.getElementsByClassName("el-scrollbar__wrap")[2].scrollTop;if(null!=document.getElementById("currTreeTable")&&(document.getElementById("currTreeTable").clientHeight-700-t<=50&&this.scrollShow)){var e=this.formatData.length+1,i=this.formatData.length+101,a=this.allData.length;if(i>=a){i=a;var o=_.slice(this.allData,e,i);this.formatData=_.concat(this.formatData,o),this.loadShow=!1}if(this.loadShow){o=_.slice(this.allData,e,i);this.formatData=_.concat(this.formatData,o)}this.scrollShow=!1;var n=this;setTimeout(function(){n.scrollShow=!0},1500)}},getList:function(){var t=this;this.$store.dispatch(this.option.apiName+"_getList").then(function(e){e=a.r.apply(null,[e.data.rows,t.option.expandAll,t.option.children]);t.allData=e,t.formatData=_.take(e,100)})},initData:function(){var t=this.option.columns,e=t.length,i=this.option.hasPermission;i.edit.isShow&&i.edit.flag&&this.getHasPermission(i.edit),i.del.isShow&&i.del.flag&&this.getHasPermission(i.del),i.addSub.isShow&&i.addSub.flag&&this.getHasPermission(i.addSub);for(var a=0;a<e;a++)if(t[a].dict){if(t[a].dict.dictData&&t[a].dict.dictData.length>0)continue;this.getDictType(t[a].dict)}},getDictType:function(t){var e=this,i=arguments;Object(a.j)(t.method)?this.$store.dispatch("dict_getDictListByType",t.dictType).then(function(){if(t.dictData=e.$store.state.dict.dictListType,i.length>1)for(var a=1;a<i.length;a++)i[a].dictData=t.dictData}):this.$store.dispatch(t.method,t.params).then(function(i){i&&"200"==i.code?t.dictData=i.data.rows:e.$message({message:i.message||"字典获取失败",showClose:!0,type:"error",duration:3e3})})},getHasPermission:function(t){var e=this;this.$store.dispatch("hasPermission",t.flag).then(function(){t.isPermission=e.$store.state.common.hasPermission})},showRow:function(t){var e=!t.row.parent||t.row.parent._expanded&&t.row.parent._show;return t.row._show=e,e?"animation:treeTableShow 1s;-webkit-animation:treeTableShow 1s;":"display:none;"},toggleExpanded:function(t){var e=this.formatData[t];e._expanded=!e._expanded},iconShow:function(t,e){return 0===t&&e[this.option.children]&&e[this.option.children].length>0},editRow:function(t,e){Object(a.j)(e)?(this.option.formId=t.id,this.option.activeName=this.option.apiName+"form"):this.$emit(e,t)},addSubRow:function(t,e){Object(a.j)(e)?(this.option.formParentId=t.id,this.option.activeName=this.option.apiName+"form"):this.$emit(e,t)},delRow:function(t,e,i){var a=this;this.$confirm("要删除该"+this.option.name+"及所有子"+this.option.name+"项吗？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.$store.dispatch(a.option.apiName+"_delete",i.id).then(function(t){t&&"200"==t.code?(a.$message({message:"删除成功",showClose:!0,type:"success",duration:3e3}),a.getList()):a.$message({message:t.message,showClose:!0,type:"error",duration:3e3})})}).catch(function(){})}}},r={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"tree-table"},[i("table-opear",{attrs:{option:t.option},on:{changeColumn:t.changeColumn,refresh:t.refresh}}),t._v(" "),i("el-table",t._b({staticStyle:{width:"100%"},attrs:{data:t.formatData,id:"currTreeTable","row-style":t.showRow,stripe:""}},"el-table",t.$attrs,!1),[t._l(t.option.columns,function(e,a){return[-1!=t.columnsShow.indexOf(e.prop)?i("el-table-column",{key:a,attrs:{prop:e.prop,label:e.label+(e.labelUnit||""),width:e.width},scopedSlots:t._u([{key:"default",fn:function(o){return[0===a?i("span",t._l(o.row._level,function(t){return i("span",{key:t,staticClass:"ms-tree-space"})}),0):t._e(),t._v(" "),t.iconShow(a,o.row)?i("span",{staticClass:"tree-ctrl",on:{click:function(e){return t.toggleExpanded(o.$index)}}},[o.row._expanded?i("i",{staticClass:"el-icon-caret-bottom"}):i("i",{staticClass:"el-icon-caret-right"})]):t._e(),t._v(" "),[e.dict?i("span",[e.dict.tags&&e.dict.tags.length>0?[i("el-tag",{key:a,attrs:{type:t.getDictLabel(o.row[e.prop],e.dict.tags).label}},[t._v("\n                  "+t._s(t.getDictLabel(o.row[e.prop],e.dict.dictData).label)+"\n                ")])]:[i("span",[t._v(t._s(t.getDictLabel(o.row[e.prop],e.dict.dictData).label))])]],2):i("span",[e.isClick?i("span",{staticClass:"atitle",on:{click:function(i){return t.editRow(o.row,e.clickFunction)}}},[t._v(" "+t._s(o.row[e.prop])+" ")]):e.isMoney?i("span",[t._v(" "+t._s(t.thousandBitSeparator(o.row[e.prop]))+" ")]):i("span",[t._v(" "+t._s(o.row[e.prop]?o.row[e.prop]:"——")+" ")])])]]}}],null,!0)}):t._e()]}),t._v(" "),i("el-table-column",{attrs:{label:"操作",width:"320"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._t("menu",null,{row:e.row,index:e.$index}),t._v(" "),t.option.hasPermission.edit.isShow&&t.option.hasPermission.edit.isPermission?i("base-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini",content:"编辑"},on:{buttonEvent:function(i){return t.editRow(e.row)}}}):t._e(),t._v(" "),t.option.hasPermission.del.isShow&&t.option.hasPermission.del.isPermission?i("base-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini",content:"删除"},on:{buttonEvent:function(i){return t.delRow(e.$index,t.formatData,e.row)}}}):t._e(),t._v(" "),t.option.hasPermission.addSub.isShow&&t.option.hasPermission.addSub.isPermission?i("base-button",{attrs:{type:"success",icon:"el-icon-plus",size:"mini",content:"添加下级"+t.option.name},on:{buttonEvent:function(i){return t.addSubRow(e.row)}}}):t._e()]}}],null,!0)}),t._v(" "),t._t("default")],2)],1)},staticRenderFns:[]};var l=i("C7Lr")(s,r,!1,function(t){i("X5eR"),i("DfwC")},"data-v-3c40e060",null);e.a=l.exports},X5eR:function(t,e){}});