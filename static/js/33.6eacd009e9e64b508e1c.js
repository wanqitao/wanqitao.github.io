webpackJsonp([33],{ta9J:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("0qgA"),o=(a("w3CS"),{name:"noTifyManagerform",components:{formFile:a("gnUw").a},props:{formId:{type:String,default:""},readOnly:{type:Boolean,default:!1}},data:function(){var e=this;return{onotifyRead:[],option:{name:"通告管理",apiName:"noTifyManager",labelWidth:"150px",callback:{},initObject:{id:this.formId,pageNo:1,pageSize:this.readOnly?10:1e4},hasPermission:{save:{isShow:!this.readOnly,isPermission:!0},back:{isShow:!0,isPermission:!0}},formObject:{},columns:[{label:"标题",value:"title",type:"input",columnOffset:{col:18,offset:3},disHid:!1,disabled:this.readOnly,rule:[{required:!0,message:"标题不能为空",trigger:"blur"},{min:0,max:64,message:"标题长度必须介于 0 到 64 之间",trigger:"blur"}]},{label:"类型",value:"type",type:"select",columnOffset:{col:18,offset:3},dict:{dictType:"oa_notify_type",dictData:[]},disHid:!1,disabled:this.readOnly,rule:[{required:!0,message:"类型不能为空",trigger:"change"}]},{label:"状态",value:"status",type:"select",columnOffset:{col:18,offset:3},dict:{dictType:"oa_notify_status",dictData:[]},disHid:!1,disabled:this.readOnly,rule:[{required:!0,message:"状态不能为空",trigger:"change"}]},{label:"接收人",value:"oaNotifyRecordIds",name:"oaNotifyRecordNames",type:"tree",disHid:!1,disabled:this.readOnly,columnOffset:{col:18,offset:3},callback:function(t,a,i){for(var o=[],n=0;n<t.length;n++)t[n].children&&t[n].children.length>0||o.push(t[n]);e.$set(i.formObject,a.name,e.arrayToString(o,"name")),e.$set(i.formObject,a.value,e.arrayToString(o,"id"))},tree:{filter:{isFilter:!0},isMultiple:!0,defaultProps:{id:"id",children:"children",label:"name"},treeMethod:"area_TreeUserData",treeObject:!0,treeData:[]}},{label:"内容",value:"content",type:"textarea",columnOffset:{col:18,offset:3},disHid:!1,disabled:this.readOnly,rule:[{required:!0,message:"内容不能为空",trigger:"blur"},{min:0,max:500,message:"cron表达式长度必须介于 0 到 500 之间",trigger:"blur"}]},{label:"接收人",value:"oaNotifyRecordList",type:"slot",slotName:"oaNotifyRecordList"}],formChildInfo:[]}}},created:function(){var e=this;this.$store.dispatch("dict_getDictListByType","oa_notify_read").then(function(){e.onotifyRead=e.$store.state.dict.dictListType})},methods:{goBack:function(){this.$emit("goBack")},handleSizeChange:function(e){this.option.initObject.pageSize=e,this.$store.dispatch("noTifyManager_form",this.option.initObject)},handleCurrentChange:function(e){this.option.initObject.pageNo=e,this.$store.dispatch("noTifyManager_form",this.option.initObject)}}}),n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("form-file",{attrs:{option:e.option},on:{goBack:e.goBack},scopedSlots:e._u([{key:"oaNotifyRecordList",fn:function(t){var i=t.slotValue;return e.readOnly?[a("el-col",{attrs:{span:18,offset:3}},[a("el-form-item",{attrs:{label:"接收人:"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.option.formObject[i],border:"",stripe:""}},[a("el-table-column",{attrs:{fixed:"",prop:"userName",label:"接收人",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"officeName",label:"接收部门",width:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"readFlag",label:"阅读状态",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(e.onotifyRead,function(i,o){return a("span",{key:o},[i.value===t.row.readFlag?a("span",[e._v(e._s(i.label))]):e._e()])})}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{prop:"readDate",label:"阅读时间",width:""}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:18,offset:5}},[a("div",{staticStyle:{"text-align":"center"}},[a("el-pagination",{attrs:{background:"","current-page.sync":"1","page-sizes":[10,30,50,100],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:e.option.formObject.count},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)]),e._v(" "),a("el-col",{attrs:{span:18,offset:5}},[a("div",{staticStyle:{display:"flex","justify-content":"space-around","margin-bottom":"20px"}},[a("span",[e._v("未查阅： "+e._s(e.option.formObject.unReadNum))]),e._v(" "),a("span",[e._v("已查阅： "+e._s(e.option.formObject.readNum))]),e._v(" "),a("span",[e._v("总共： "+e._s(Number(e.option.formObject.unReadNum)+Number(e.option.formObject.readNum)))])])])]:void 0}}],null,!0)})},staticRenderFns:[]},r=a("C7Lr")(o,n,!1,null,null,null).exports,s=a("ANQr"),l={name:"noTifyManager",components:{quickTable:i.a,quickForm:r,baseButton:s.a},data:function(){return{readOnly:!1,hasPermission:!1,option:{selection:!1,showIndex:!0,tableMenu:!0,isPage:!0,name:"通告",apiName:"noTifyManager",activeName:"noTifyManager",formId:"",searchObject:{type:"",title:"",pageNo:1,pageSize:15},hasPermission:{edit:{isShow:!1,isPermission:!0},del:{isShow:!0,isPermission:!0}},columns:[{label:"标题",prop:"title"},{label:"状态",prop:"status",dict:{dictType:"oa_notify_status",dictData:[]},isTag:!0},{label:"类型",prop:"type",dict:{dictType:"oa_notify_type",dictData:[]}},{label:"更新时间",prop:"updateDate"}],searchColums:[{label:"类型",value:"type",type:"select",dict:{dictType:"oa_notify_type",dictData:[]}},{label:"标题",value:"title",type:"input"}]}}},created:function(){var e=this;this.$store.dispatch("hasPermission","oa:oaNotify:edit").then(function(){e.hasPermission=e.$store.state.common.hasPermission})},methods:{oaedit:function(e){"1"==e.status?this.readOnly=!0:this.readOnly=!1,this.option.formId=e.id,this.option.activeName="noTifyManagerform"},goBack:function(){this.option.formId="",this.option.activeName="noTifyManager",this.$refs.quickTable.getList(),this.readOnly=!1},handleClick:function(e,t){"noTifyManager"==e.name&&(this.option.formId="",this.readOnly=!1)}}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",{},[a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.option.activeName,callback:function(t){e.$set(e.option,"activeName",t)},expression:"option.activeName"}},[a("el-tab-pane",{attrs:{label:"通告列表",name:"noTifyManager"}},[a("quick-table",{ref:"quickTable",attrs:{option:e.option},scopedSlots:e._u([{key:"menuTop",fn:function(t){var i=t.row;return[a("base-button",{attrs:{type:"1"==i.status?"success":"primary",icon:"1"==i.status?"el-icon-search":"el-icon-edit",size:"mini",content:"1"==i.status?"查看":"编辑"},on:{buttonEvent:function(t){return e.oaedit(i)}}})]}}])})],1),e._v(" "),a("el-tab-pane",{attrs:{label:""==e.option.formId?"通告添加":e.readOnly?"通告查看":"通告编辑",name:"noTifyManagerform"}},["noTifyManagerform"==e.option.activeName?a("quick-form",{attrs:{formId:e.option.formId,readOnly:e.readOnly},on:{goBack:e.goBack}}):e._e()],1)],1)],1)])},staticRenderFns:[]},d=a("C7Lr")(l,c,!1,null,null,null);t.default=d.exports}});