webpackJsonp([30],{"6GjQ":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r("TIfe"),o=r("LUZf"),a=r("BD2p"),l={name:"resultPass",components:{},data:function(){var e=this;return{activeName:"usermodifyPwd",loading:!1,ruleForm:{id:"",oldPassword:"",newPassword:"",qNewWord:""},saveLoding:!1,rules:{oldPassword:[{required:!0,message:"密码不能为空",trigger:"blur"},{validator:function(t,r,s){""===r?s(new Error("密码不能为空")):e.$store.dispatch("userInfo_checkOldPassword",{password:r}).then(function(e){e.data&&e.data.validate?s():s(new Error("旧密码错误"))})},trigger:"blur"}],newPassword:[{required:!0,message:"新密码不能为空",trigger:"blur"},{validator:function(t,r,s){""===r?s(new Error("请输入密码")):(""!==e.ruleForm.qNewWord&&e.$refs.ruleForm.validateField("qNewWord"),s())},trigger:"blur"},{min:0,max:16,message:"长度不能超过16字符",trigger:"blur"}],qNewWord:[{required:!0,message:"确认密码不能为空",trigger:"blur"},{validator:function(t,r,s){""===r?s(new Error("请再次输入密码")):r!==e.ruleForm.newPassword?s(new Error("两次输入密码不一致!")):s()},trigger:"blur"}]}}},computed:{userId:function(){return this.$store.state.user.userId}},methods:{submitForm:function(e){var t=this;this.saveLoding=!0,this.$refs[e].validate(function(r){if(!r)return t.saveLoding=!1,console.log("error submit!!"),!1;t.ruleForm.id=t.userId,t.ruleForm.qNewWord=t.ruleForm.newPassword;try{t.$store.dispatch("userInfo_ResltPass",t.ruleForm).then(function(r){"200"===r.code&&(t.$message({message:"修改成功",showClose:!0,type:"success",duration:3e3}),t.logOut()),t.saveLoding=!1,t.$refs[e].resetFields()})}catch(e){t.saveLoding=!1,console.log(e)}})},resetForm:function(e){this.$refs[e].resetFields()},logOut:function(){var e=this;this.$store.dispatch("user_LogOut").then(function(){e.$router.push({path:"/"})}).catch(function(){console.log("退出失败")})}}},i={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"infoform",staticStyle:{"margin-top":"30px"}},[r("div",{staticClass:"form_title"},[e._v("修改密码")]),e._v(" "),r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,"status-icon":"",rules:e.rules,"label-width":"100px"}},[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:10,offset:7}},[r("el-form-item",{attrs:{label:"旧密码:",prop:"oldPassword"}},[r("el-input",{staticStyle:{width:"90%"},attrs:{type:"password",placeholder:"请输入旧密码","show-password":""},model:{value:e.ruleForm.oldPassword,callback:function(t){e.$set(e.ruleForm,"oldPassword","string"==typeof t?t.trim():t)},expression:"ruleForm.oldPassword"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:10,offset:7}},[r("el-form-item",{attrs:{label:"新密码:",prop:"newPassword"}},[r("el-input",{staticStyle:{width:"90%"},attrs:{type:"password","show-password":"",placeholder:"请输入新密码"},model:{value:e.ruleForm.newPassword,callback:function(t){e.$set(e.ruleForm,"newPassword","string"==typeof t?t.trim():t)},expression:"ruleForm.newPassword"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:10,offset:7}},[r("el-form-item",{attrs:{label:"确认密码:",prop:"qNewWord"}},[r("el-input",{staticStyle:{width:"90%"},attrs:{type:"password",placeholder:"请输入确认密码","show-password":""},model:{value:e.ruleForm.qNewWord,callback:function(t){e.$set(e.ruleForm,"qNewWord","string"==typeof t?t.trim():t)},expression:"ruleForm.qNewWord"}})],1)],1)],1),e._v(" "),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12,offset:6}},[r("el-form-item",{staticClass:"save-return",staticStyle:{"margin-top":"70px"}},[r("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置")]),e._v(" "),r("el-button",{attrs:{type:"primary",loading:e.saveLoding},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)])},staticRenderFns:[]},n=r("C7Lr")(l,i,!1,null,null,null).exports,u={name:"userInfo",components:{upload:a.a,userModifyPwd:n},data:function(){return{activeName:"userInfo",saveLoding:!1,userInfo:{loginName:"",areaName:"",name:"",officeName:"",email:"",roleNames:"",mobile:""},rules:{email:[{required:!0,message:"邮箱不能为空",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],mobile:[{required:!0,validator:function(e,t,r){var s=/^1[345789]\d{9}$/.test(t);""===t?r(new Error("请输入手机号码")):s?r():r(new Error("请输入正确的手机号"))},trigger:"blur"}],remarks:[{required:!1,trigger:"blur"},{min:0,max:250,message:"备注最大长度为250位",trigger:"blur"}]}}},created:function(){this.getUserInfo()},computed:{userId:function(){return Object(s.a)(o.a.userId)}},methods:{getUserInfo:function(){var e=this;this.$store.dispatch("user_form",{id:this.userId}).then(function(t){e.userInfo=t.data.formObject})},handleClick:function(e){},submitSave:function(e){var t=this;this.saveLoding=!0,this.$refs[e].validate(function(e){if(!e)return t.saveLoding=!1,console.log("表单验证失败"),!1;delete t.userInfo.roleIdList;try{t.$store.dispatch("user_SaveUser",t.userInfo).then(function(e){t.$store.dispatch("user_form",{id:t.userId}).then(function(e){e&&"200"==e.code&&t.$message({message:"修改成功",showClose:!0,type:"success",duration:3e3}),t.userInfo=e.data.formObject}),t.saveLoding=!1})}catch(e){t.saveLoding=!1,console.log(e)}})}}},d={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[r("el-tab-pane",{attrs:{label:"个人信息",name:"userInfo"}},[r("div",{staticClass:"infoform",staticStyle:{"margin-top":"30px"}},[r("div",{staticClass:"form_title"},[e._v("个人基本信息")]),e._v(" "),r("el-form",{ref:"ruleForm",staticClass:"baseform",attrs:{model:e.userInfo,rules:e.rules,"label-width":"80px"}},[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"登录名:"}},[r("el-input",{staticStyle:{width:"90%"},attrs:{disabled:""},model:{value:e.userInfo.loginName,callback:function(t){e.$set(e.userInfo,"loginName",t)},expression:"userInfo.loginName"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"归属区域:"}},[r("el-input",{staticStyle:{width:"90%"},attrs:{disabled:""},model:{value:e.userInfo.areaName,callback:function(t){e.$set(e.userInfo,"areaName",t)},expression:"userInfo.areaName"}})],1)],1)],1),e._v(" "),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"姓名:"}},[r("el-input",{staticStyle:{width:"90%"},attrs:{disabled:""},model:{value:e.userInfo.name,callback:function(t){e.$set(e.userInfo,"name",t)},expression:"userInfo.name"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"归属部门:"}},[r("el-input",{staticStyle:{width:"90%"},attrs:{disabled:""},model:{value:e.userInfo.officeName,callback:function(t){e.$set(e.userInfo,"officeName",t)},expression:"userInfo.officeName"}})],1)],1)],1),e._v(" "),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"邮箱:",prop:"email"}},[r("el-input",{staticStyle:{width:"90%"},attrs:{placeholder:"请输入邮箱"},model:{value:e.userInfo.email,callback:function(t){e.$set(e.userInfo,"email","string"==typeof t?t.trim():t)},expression:"userInfo.email"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"用户角色:"}},[r("el-input",{staticStyle:{width:"90%"},attrs:{disabled:""},model:{value:e.userInfo.roleNames,callback:function(t){e.$set(e.userInfo,"roleNames","string"==typeof t?t.trim():t)},expression:"userInfo.roleNames"}})],1)],1)],1),e._v(" "),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"手机:",prop:"mobile"}},[r("el-input",{staticStyle:{width:"90%"},attrs:{placeholder:"请输入手机"},model:{value:e.userInfo.mobile,callback:function(t){e.$set(e.userInfo,"mobile","string"==typeof t?t.trim():t)},expression:"userInfo.mobile"}})],1)],1)],1),e._v(" "),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"备注:",prop:"remarks"}},[r("el-input",{staticStyle:{width:"95%"},attrs:{type:"textarea",placeholder:"请输入备注",rows:6},model:{value:e.userInfo.remarks,callback:function(t){e.$set(e.userInfo,"remarks","string"==typeof t?t.trim():t)},expression:"userInfo.remarks"}})],1)],1)],1),e._v(" "),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12,offset:6}},[r("el-form-item",{staticClass:"save-return"},[r("el-button",{attrs:{type:"primary",loading:e.saveLoding},on:{click:function(t){return e.submitSave("ruleForm")}}},[e._v("保存")])],1)],1)],1)],1)],1)]),e._v(" "),r("el-tab-pane",{attrs:{label:"修改密码",name:"usermodifyPwd"}},["usermodifyPwd"==e.activeName?r("userModifyPwd"):e._e()],1)],1)],1)},staticRenderFns:[]},m=r("C7Lr")(u,d,!1,null,null,null);t.default=m.exports}});