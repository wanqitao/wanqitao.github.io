webpackJsonp([18],{"CUz/":function(e,t){},f2mQ:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("0qgA"),r=i("aA9S"),s=i.n(r),l=i("gnUw"),o=i("w3CS"),n={components:{quickForm:l.a},props:{formId:{type:String,default:""},readOnly:{type:Boolean,default:!1}},watch:{statuss:{handler:function(e,t){this.record="1"==e,this.option.columns[12].disHid="1"!=e,this.option.columns[13].disHid="1"!=e,this.option.columns[14].disHid="1"!=e,this.option.columns[15].disHid="1"!=e},deep:!0}},mounted:function(){},computed:{statuss:function(){return this.option.formObject.status}},created:function(){},data:function(){var e=this;return{record:!1,option:{name:"资产登记",apiName:"register",callback:{initCallback:function(){e.$store.dispatch("register_form",e.option.initObject).then(function(t){t&&"200"==t.code?(e.option.formObject=s()({},e.option.formObject,t.data.formObject),e.$store.dispatch("class_form",{id:e.option.formObject.classId}).then(function(t){e.option.columns[3].dict.dictData=t.data.formObject.brands})):e.$message({message:t.message||"获取失败",showClose:!0,type:"error",duration:3e3})})}},initObject:{id:this.formId},hasPermission:{save:{isShow:!this.readOnly,isPermission:!0},back:{isShow:"true",isPermission:!0}},columns:[{label:"所属部门",value:"officeId",name:"officeName",type:"tree",disHid:!1,disabled:this.readOnly,rule:[{required:!0,message:"所属部门不能为空",trigger:"change"}],tree:{defaultProps:{id:"id",children:"children",label:"name"},treeMethod:"office_getOfficeTree",treeObject:{isUser:!0},treeData:[]}},{label:"资产名称",value:"name",type:"input",disHid:!1,disabled:this.readOnly,rule:[{required:!0,message:"资产名称不能为空",trigger:"blur"},{min:0,max:64,message:"资产名称长度必须介于 0 到 64 之间",trigger:"blur"}]},{label:"资产分类",value:"classId",type:"select",dict:{dictType:"",defaultProps:{label:"className",value:"id"},dictData:e.$store.dispatch("class_getList",{pageNo:-1}).then(function(e){return function(e){return e}(e.data.rows)})},callback:function(t){e.$store.dispatch("class_form",{id:t.id}).then(function(t){e.option.formObject.brandId="",e.option.columns[3].dict.dictData=t.data.formObject.brands})},disHid:!1,disabled:this.readOnly,rule:[{required:!0,message:"资产分类不能为空",trigger:"change"}]},{label:"资产品牌",value:"brandId",type:"select",dict:{defaultProps:{label:"brandName",value:"brandId"},dictType:"",dictData:[]},disHid:!1,disabled:this.readOnly,rule:[{required:!0,message:"资产品牌不能为空",trigger:"change"}]},{label:"型号",value:"type",type:"input",disHid:!1,disabled:this.readOnly,rule:[{required:!0,message:"型号不能为空",trigger:"blur"},{min:0,max:64,message:"型号长度必须介于 0 到 64 之间",trigger:"blur"}]},{label:"序列号",value:"serialNumber",type:"input",disHid:!1,disabled:this.readOnly,rule:[{required:!0,message:"序列号不能为空",trigger:"blur"},{min:0,max:64,message:"序列号长度必须介于 0 到 64 之间",trigger:"blur"},{validator:o.e({validateMethod:"register_validateSerialNumber",name:"序列号",keyField:"serialNumber",fileId:this.formId}),trigger:"blur"}]},{label:"成本",value:"cost",labelUnit:"(元)",type:"number",disHid:!1,disabled:this.readOnly,rule:[{required:!0,message:"成本不能为空",trigger:"blur"},{validator:o.b({self:this,precision:2,name:"成本",keyField:"option.formObject.cost"}),trigger:"blur"}]},{label:"采购日期",value:"purchaseDate",type:"date",disHid:!1,disabled:this.readOnly,rule:[{required:!0,message:"采购日期不能为空",trigger:"change"}]},{label:"资产状态",value:"status",type:"select",dict:{dictType:"asset_status",dictData:[]},callback:function(t){"1"!=t.value&&(e.option.formObject.recipientsName="",e.option.formObject.recipientsId="",e.option.formObject.receiveOfficeId="",e.option.formObject.receiveOfficeName="",e.option.formObject.position="",e.option.formObject.receiveDate="")},disHid:!1,disabled:this.readOnly,rule:[{required:!0,message:"资产状态不能为空",trigger:"change"}]},{label:"备注",value:"remarks",type:"textarea",disHid:!1,disabled:this.readOnly,rule:[{min:0,max:500,message:"备注长度必须介于 0 到 500 之间",trigger:"blur"}]},{label:"资产附件",value:"files",type:"upload",disHid:!1,disabled:this.readOnly},{label:"line",value:"line",type:"slot",slotName:"line"},{label:"领用人",value:"recipientsId",name:"recipientsName",type:"tree",disHid:!0,disabled:this.readOnly,rule:[{required:!0,message:"领用人不能为空",trigger:"change"}],callback:function(t,i,a){e.$set(a.formObject,i.name,t.name),e.$set(a.formObject,i.value,t.id),e.$set(a.formObject,"receiveOfficeName",t.officeName),e.$set(a.formObject,"receiveOfficeId",t.officeId)},tree:{defaultProps:{id:"id",children:"children",label:"name"},filter:{isFilter:!0},treeMethod:"office_getOfficeUserTree",treeObject:{isUser:!0},treeData:[]}},{label:"领用部门",value:"receiveOfficeName",type:"input",placeholder:"选择领用人自动带出",disHid:!0,disabled:!0,rule:[{required:!0,message:"领用部门不能为空",trigger:"change"}]},{label:"资产位置",value:"position",type:"input",disHid:!0,disabled:this.readOnly,rule:[{required:!0,message:"资产位置不能为空",trigger:"blur"},{min:0,max:64,message:"资产位置长度必须介于 0 到 64 之间",trigger:"blur"}]},{label:" 领用日期",value:"receiveDate",type:"date",disHid:!0,disabled:this.readOnly,rule:[{required:!0,message:"领用日期不能为空",trigger:"change"},{required:!0,validator:function(t,i,a){var r=(new Date(i+" 00:00:00")-new Date(e.option.formObject.purchaseDate+" 00:00:00"))/864e5;console.log(r),r<0?a(new Error("领用日期不能小于采购日期")):a()},trigger:"change"}]}],formObject:{brandId:"",recipientsId:"",recipientsName:"",receiveOfficeName:"",position:"",receiveDate:""}}}},methods:{goBack:function(){this.$emit("goBack")}}},d={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"registerform"},[t("quick-form",{attrs:{option:this.option},on:{goBack:this.goBack}},[this.record?t("template",{slot:"line"},[t("el-col",{attrs:{span:12}}),this._v(" "),t("el-col",{staticClass:"col_line"},[t("div",{staticClass:"form_title line"},[this._v("领用信息")])])],1):this._e()],2)],1)},staticRenderFns:[]};var c=i("C7Lr")(n,d,!1,function(e){i("CUz/")},null,null).exports,u=i("BD2p"),m={name:"registerList",components:{quickTable:a.a,quickForm:c,upload:u.a},directives:{prentcss:{inserted:function(e,t){e.parentNode.setAttribute("style","display: flex;line-height: 32px; height: 32px;")}}},data:function(){return{option:{activeName:"register",formId:"",name:"资产登记",apiName:"register",isExport:!1,readOnly:!1,exportTitle:"下载模板",exportMethod:"register_downloadTemplate",hasPermission:{edit:{isShow:!0,flag:"assetsReg:edit",isPermission:!1},del:{isShow:!0,flag:"assetsReg:remove",isPermission:!0}},columns:[{label:"所属部门",prop:"officeName"},{label:"资产名称",prop:"name"},{label:"资产分类",prop:"className"},{label:"资产品牌",prop:"brandName"},{label:"资产状态",prop:"status",dict:{dictType:"asset_status",dictData:[],tags:[{label:"success",value:"0"},{label:"warning",value:"1"},{label:"danger",value:"2"}]}},{label:"采购日期",prop:"purchaseDate"},{label:"领用部门",prop:"receiveOfficeName"},{label:"领用人",prop:"recipientsName"}],searchObject:{name:"",purchaseDate:"",officeId:"",pageNo:1,pageSize:15},searchColums:[{label:"所属部门",value:"officeId",name:"officeName",type:"tree",tree:{defaultProps:{id:"id",children:"children",label:"name"},treeMethod:"office_getOfficeTree",treeObject:{},treeData:[]}},{label:"资产名称",value:"name",type:"input"},{label:"采购日期",value:"daterange",type:"daterange"},{label:"领用部门",value:"receiveOfficeId",name:"recipientsName",type:"tree",tree:{defaultProps:{id:"id",children:"children",label:"name"},treeMethod:"office_getOfficeTree",treeObject:{},treeData:[]}}]}}},created:function(){this.getHasPermission()},computed:{formLabel:function(){return this.option.formId?this.option.readOnly?"资产登记查看":"资产登记编辑":"资产登记添加"}},methods:{getHasPermission:function(){var e=this;this.$store.dispatch("hasPermission","assetsReg:edit").then(function(){e.option.isExport=e.$store.state.common.hasPermission})},exportExcel:function(e){this.$message({message:"功能正在开发中",showClose:!0,type:"warning",duration:3e3})},goBack:function(){this.option.formId="",this.option.activeName="register",this.option.readOnly=!1,this.$refs.quickTable.getList()},handleClick:function(e,t){"register"==e.name&&(this.option.formId="",this.option.readOnly=!1,this.$refs.quickTable.getList())}}},p={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{},[i("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.option.activeName,callback:function(t){e.$set(e.option,"activeName",t)},expression:"option.activeName"}},[i("el-tab-pane",{attrs:{label:"资产登记列表",name:"register"}},[i("quick-table",{ref:"quickTable",attrs:{option:e.option}},[i("template",{slot:"slotafter"},[e.option.isExport?[i("upload",{directives:[{name:"prentcss",rawName:"v-prentcss"}],staticStyle:{left:"9px"},attrs:{fileType:"xls",method:"/assetsReg/importAssets",showList:!1,limit:100,type:"success",title:"批量导入"}})]:e._e()],2)],2)],1),e._v(" "),e.option.readOnly||e.option.hasPermission.edit.isPermission?i("el-tab-pane",{attrs:{label:e.formLabel,name:"registerform"}},["registerform"==e.option.activeName?i("quick-form",{attrs:{formId:e.option.formId,readOnly:e.option.readOnly},on:{goBack:e.goBack}}):e._e()],1):e._e()],1)],1)])},staticRenderFns:[]},f=i("C7Lr")(m,p,!1,null,null,null);t.default=f.exports}});