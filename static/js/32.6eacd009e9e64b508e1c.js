webpackJsonp([32],{Ebdn:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("c/w/"),i=a("oAV5"),s={data:function(){return{officeDialog:!1,filterText:"",treeObject:{name:"",id:"",node:"",nodes:[]}}},props:{value:{type:String,default:""},name:{type:String,default:""},title:{type:String,default:"区域树"},defaultProps:{type:Object,default:function(){return{id:"id",children:"children",label:"text"}}},treeData:{type:Array,required:!0}},created:function(){this.treeObject.name=this.name,this.treeObject.id=this.value,this.$refs.tree&&this.$refs.tree.setCurrentKey(this.value)},updated:function(){this.treeObject.name=this.name,this.treeObject.id=this.value},computed:{expandedKeys:function(){return this.value?Object(i.i)(this.value,this.treeData,this.defaultProps):void 0===this.treeData[0]?[]:[this.treeData[0].id]},checkedKeys:function(){return this.value?this.value.split(","):[]},nodeKey:function(){return this.defaultProps.id},label:function(){return this.defaultProps.label}},methods:{getCurrentData:function(e,t){var a=this.nodeKey;this.treeObject.id=e[a],this.emitInput(e,t)},refreshTree:function(){this.$emit("refreshTree")},emitInput:function(e,t){this.$emit("currentChange",e,t)},messageSubstring:i.n}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"leftTree"},[a("div",{staticClass:"treeTitle"},[e._v("\n    "+e._s(e.title)+"\n    "),a("span",{on:{click:e.refreshTree}},[a("i",{staticClass:"el-icon-refresh"})])]),e._v(" "),a("el-scrollbar",{staticStyle:{height:"100%",border:"1px solid #eee"}},[a("div",{staticClass:"officeTree"},[a("el-tree",{ref:"tree",staticClass:"filter-tree",attrs:{data:e.treeData,props:e.defaultProps,"highlight-current":!0,"expand-on-click-node":!1,"check-on-click-node":"","node-key":e.nodeKey,"current-node-key":e.value,"default-checked-keys":e.checkedKeys,"default-expanded-keys":e.expandedKeys},on:{"current-change":e.getCurrentData},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.node;return t.data,a("span",{staticClass:"custom-tree-node",staticStyle:{width:"100%"}},[a("span",{attrs:{title:r.label}},[e._v(e._s(e.messageSubstring(r.label,36)))])])}}])})],1)])],1)},staticRenderFns:[]},o=a("C7Lr")(s,l,!1,null,null,null).exports,n=a("w3CS"),c={name:"userform",components:{formFile:a("gnUw").a},props:{formId:{type:String,default:""}},data:function(){var e=this;return{option:{name:"用户",apiName:"user",labelWidth:"110px",callback:{},initObject:{id:this.formId},hasPermission:{save:{isShow:!0,isPermission:!0},back:{isShow:!0,isPermission:!0}},formObject:{loginFlag:"1",roleIdList:[]},assistParams:{newPassword:"password"},columns:[{label:"归属部门",value:"officeId",name:"officeName",type:"tree",tree:{isMultiple:!1,defaultProps:{id:"id",children:"children",label:"name"},treeMethod:"office_getOfficeTree",treeObject:{type:"",extId:""},treeData:[]}},{label:"姓名",value:"name",type:"input",maxlength:10,disHid:!1,disabled:!1,rule:[{required:!0,message:"姓名不能为空"}]},{label:"登录名",value:"loginName",type:"input",maxlength:15,disHid:!1,disabled:!1,rule:[{required:!0,message:"登录名不能为空"},{validator:n.e({validateMethod:"user_checkLoginName",name:"登录名",keyField:"loginName",fileId:this.formId}),trigger:"blur"},{pattern:/^[\w]+$/,message:"登录名只支持数字、字母和下划线组成"}]},{label:"用户类型",value:"userType",type:"select",dict:{dictType:"sys_user_type",dictData:[]},disHid:!1,disabled:!1,rule:[{required:!0,message:"用户类型不能为空"}]},{label:"是否允许登录",value:"loginFlag",type:"select",dict:{dictType:"yes_no",dictData:[]},tooltipContent:"“是”代表此账号允许登录，“否”则表示此账号不允许登录",rule:[{required:!0,message:"是否允许登录不能为空"}],disHid:!1,disabled:!1},{label:"密码",value:"password",type:"slot",slotName:"password",rule:[{required:!this.formId,message:"请输入密码",trigger:"blur"},{min:0,max:16,message:"密码长度必须介于 0 到 16 之间",trigger:"blur"}]},{label:"确认密码",value:"cpassword",type:"slot",slotName:"cpassword",rule:[{required:!this.formId,message:"请输入密码",trigger:"blur"},{min:0,max:16,message:"密码长度必须介于 0 到 16 之间",trigger:"blur"},{validator:function(t,a,r){a!==e.option.formObject.password?r(new Error("两次输入密码不一致!")):r()},trigger:"blur"}]},{label:"邮箱",value:"email",type:"input",disHid:!1,disabled:!1,rule:[{required:!1,message:"邮箱不能为空",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}]},{label:"职位",value:"position",type:"input",disHid:!1,disabled:!1},{label:"手机",value:"mobile",type:"input",disHid:!1,disabled:!1,rule:[{required:!1,validator:n.d,trigger:"blur"}]},{label:"用户角色",value:"roleIdList",type:"checkbox",disHid:!1,disabled:!1,rule:[{required:!0,message:"用户角色不能为空"}],data:{dataList:[],defaultProps:{label:"name",value:"id"},dataMethod:"role_getList",dataObject:{}}},{label:"备注",value:"remarks",type:"textarea",maxlength:225,disHid:!1,disabled:!1}],formChildInfo:[]}}},computed:{roleUserList:function(){return this.$store.state.role.roleUserList}},created:function(){},methods:{formCallback:function(){},goBack:function(){this.$emit("goBack")}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("form-file",{attrs:{option:e.option},on:{goBack:e.goBack,formCallback:e.formCallback},scopedSlots:e._u([{key:"password",fn:function(t){var r=t.slotValue,i=t.slotColumn;return[a("el-col",{attrs:{span:12}},[""==e.formId?[a("el-form-item",{attrs:{label:"密码:",prop:r,rules:i.rule}},[a("el-input",{staticStyle:{width:"100%"},attrs:{type:"password",clearable:"","show-password":"",placeholder:"请输入密码"},model:{value:e.option.formObject[r],callback:function(t){e.$set(e.option.formObject,r,"string"==typeof t?t.trim():t)},expression:"option.formObject[slotValue]"}})],1)]:[a("el-form-item",{attrs:{label:"密码:",prop:r,rules:i.rule}},[a("el-input",{staticStyle:{width:"100%"},attrs:{type:"password",clearable:"","show-password":"",placeholder:"请输入密码"},model:{value:e.option.formObject[r],callback:function(t){e.$set(e.option.formObject,r,"string"==typeof t?t.trim():t)},expression:"option.formObject[slotValue]"}}),e._v(" "),""!=e.formId?a("span",{staticStyle:{"margin-left":"12px",color:"#bbb3b3",position:"absolute",right:"-18px",top:"0px"}},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"若不修改密码请留空 ",placement:"right-start"}},[a("i",{staticClass:"icon-question-sign"})])],1):e._e()],1)]],2)]}},{key:"cpassword",fn:function(t){var r=t.slotValue,i=t.slotColumn;return[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"确认密码:",prop:r,rules:i.rule}},[a("el-input",{staticStyle:{width:"100%"},attrs:{type:"password",clearable:"","show-password":"",placeholder:"请输入密码"},model:{value:e.option.formObject[r],callback:function(t){e.$set(e.option.formObject,r,"string"==typeof t?t.trim():t)},expression:"option.formObject[slotValue]"}})],1)],1)]}}])})},staticRenderFns:[]},u=a("C7Lr")(c,d,!1,null,null,null).exports,p=a("0qgA"),f={name:"office",components:{tree:r.a,leftTree:o,quickTable:p.a,userform:u},data:function(){return{option:{selection:!1,showIndex:!0,tableMenu:!0,isPage:!0,name:"用户",apiName:"user",activeName:"user",formId:"",searchObject:{officeId:"",areaId:"",userType:"",name:"",loginName:"",pageNo:1,pageSize:15,officeName:""},hasPermission:{edit:{isShow:!0,isPermission:!0},del:{isShow:!0,isPermission:!0}},columns:[{label:"归属部门",prop:"officeName"},{label:"登录名",prop:"loginName",isClick:!0},{label:"姓名",prop:"name"},{label:"是否允许登录",prop:"loginFlag",dict:{dictType:"yes_no",dictData:[]}},{label:"用户类型",prop:"userType",dict:{dictType:"sys_user_type",dictData:[]}}],searchColums:[{label:"归属部门",value:"officeId",name:"officeName",type:"tree",tree:{isMultiple:!1,treeMethod:"office_getOfficeTree",treeObject:{type:"",extId:""},treeData:[]}},{label:"用户类型",value:"userType",type:"select",dict:{dictType:"sys_user_type",dictData:[]}},{label:"登录名",value:"loginName",type:"input"},{label:"姓名",value:"name",type:"input"}]},hasPermission:!1}},computed:{treeData:function(){return void 0===this.$store.state.area.areaTree[0]?[]:this.$store.state.area.areaTree}},created:function(){var e=this;this.$store.dispatch("area_getAreTree",{extId:"",isAllGrade:!1}),this.$store.dispatch("hasPermission","sys:user:edit").then(function(){e.hasPermission=e.$store.state.common.hasPermission})},methods:{refreshTree:function(){this.$store.dispatch("area_getAreTree",{extId:"",isAllGrade:!1}),this.option.searchObject.areaId=""},getCurrentOffice:function(e,t){this.option.searchObject.areaId=e.id,this.option.searchObject.pageNo=1,this.currentPage=this.option.searchObject.pageNo,this.$refs.quickTable.getList()},goBack:function(){this.option.formId="",this.option.activeName="user",this.$refs.quickTable.getList()},handleClick:function(e,t){"user"==e.name&&(this.option.formId="")}}},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{},[a("left-tree",{attrs:{treeData:e.treeData},on:{refreshTree:e.refreshTree,currentChange:e.getCurrentOffice}}),e._v(" "),a("el-scrollbar",{staticClass:"rightInfo",staticStyle:{height:"100%",border:"1px solid #eee","border-top":"none"}},[a("div",{staticClass:"userformScroll"},[a("div",{},[a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.option.activeName,callback:function(t){e.$set(e.option,"activeName",t)},expression:"option.activeName"}},[a("el-tab-pane",{attrs:{label:"用户列表",name:"user"}},[a("quick-table",{ref:"quickTable",attrs:{option:e.option}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:e.option.formId?"用户编辑":"用户添加",name:"userform"}},["userform"==e.option.activeName?a("userform",{attrs:{formId:e.option.formId},on:{goBack:e.goBack}}):e._e()],1)],1)],1)])])],1)},staticRenderFns:[]},h=a("C7Lr")(f,m,!1,null,null,null);t.default=h.exports}});